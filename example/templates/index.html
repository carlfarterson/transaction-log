<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script src="https://d3js.org/d3.v5.min.js"></script>
	<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
	<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
	<!-- Top container for table summarizing portfolio, and the chart to show % change in current value-->
	<div id="portfolio">
	  <table id="portfolioTable">
	    <thead id="portfolioTableHead">
	      <tr>
		      <th scope="col">Coin</th>
		      <th scope="col">Current Price ($)</th>
		      <th scope="col">Units</th>
					<th scope="col">Cost ($)</th>
					<th scope="col">Cost/Unit ($)</th>
					<th scope="col">Unrealised Dollars ($)</th>
					<th scope="col">Unrealised Pct (%)</th>
					<th scope="col">Realised Dollars ($)</th>
					<th scope="col">Gain/Loss ($)</th>
					<th scope="col">Market Value</th>
	      </tr>
	    </thead>
	    <tbody id="portfolioTableBody">
			<!-- Insert coin summary data here -->
			{% for coin in coins %}
				<tr>
					<td> {{ coin }} </td>
					<td> {{ "%.2f" | format(portfolio[coin]['last_price']) }} </td>
					<td> {{ "%.2f" | format(portfolio[coin]['units']) }} </td>
					<td> {{ "%.2f" | format(portfolio[coin]['cost']) }} </td>
					<td> {{ "%.2f" | format(portfolio[coin]['cost_per_unit']) }} </td>
					<td> {{ "%.2f" | format(portfolio[coin]['unrealised_amt']) }} </td>
					<td> {{ "%.2f" | format(portfolio[coin]['unrealised_pct'] * 100) }} </td>
					<td> {{ "%.2f" | format(portfolio[coin]['realised_amt']) }} </td>
					<td class="redgreenHeavy"> {{ "%.2f" | format(portfolio[coin]['gain_loss']) }} </td>
					<td> {{ "%.2f" | format(portfolio[coin]['market_val']) }} </td>
				</tr>
			{% endfor %}
		</tbody>
	  </table>
	</div>

	<!-- Bottom container for table showing transactions for selected coin above -->
	<div id="transactions">
		<table id="transactionsTable">
		    <thead id="transactionsTableHead">
		      <tr>
		        <th scope="col">Trade #</th>
		        <th scope="col">Date</th>
		        <th scope="col">Coin</th>
						<th scope="col">Side</th>
						<th scope="col">Units</th>
						<th scope="col">Coin Price ($)</th>
						<th scope="col">Fees ($)</th>
						<th scope="col">Previous Units</th>
						<th scope="col">Cumulative Units</th>
						<th scope="col">Transacted Value ($)</th>
						<th scope="col">Previous Cost ($)</th>
						<th scope="col">Cost of Transaction ($)</th>
						<th scope="col">Cost/Unit ($)</th>
						<th scope="col">Cumulative Cost ($)</th>
						<th scope="col">Gain/Loss From Sale ($)</th>
						<th scope="col">Realised Gain/Loss (%)</th>
		      </tr>
			</thead>
			<tbody id="transactionsTableBody">
			<!-- Insert coin transactions data here-->
				{% for transaction in transactions %}
					<tr class={{transaction.coin}}>
						<td class="yellow"> {{ transaction.trade_num }} </td>
						<td class="yellow"> {{ transaction.date.strftime("%Y-%m-%d") }} </td>
						<td class="yellow"> {{ transaction.coin }} </td>
						<td class="blue redgreenLight"> {{ transaction.side }} </td>
						<td class="yellow"> {{ "%.2f" | format(transaction.units) }} </td>
						<td class="yellow"> {{ "%.2f" | format(transaction.price_per_unit) }} </td>
						<td class="yellow"> {{ "%.2f" | format(transaction.fees) }} </td>
						<td class="blue"> {{ "%.2f" | format(transaction.previous_units) }} </td>
						<td class="blue"> {{ "%.2f" | format(transaction.cumulative_units) }} </td>
						<td class="blue"> {{ "%.2f" | format(transaction.transacted_value) }} </td>
						<td class="blue"> {{ "%.2f" | format(transaction.previous_cost) }} </td>
						<td class="blue"> {{ "%.2f" | format(transaction.cost_of_transaction) }} </td>
						<td class="blue"> {{ "%.2f" | format(transaction.cost_per_unit) }} </td>
						<td class="blue"> {{ "%.2f" | format(transaction.cumulative_cost) }} </td>
						<td class="blue redgreenHeavy"> {{ "%.2f" | format(transaction.gain_loss) }} </td>
						<td class="blue redgreenHeavy"> {{ "%.2f" | format(transaction.realised_pct * 100) }} </td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	<script src="{{ url_for('static', filename='tableSummary.js') }}" charset="utf-8"></script>
</body>
</html>
